# コンポジション(Composition)と柔軟な設計

## 継承とコンポジション

設計の観点では継承よりコンポジションを使うべき。  
継承は子クラスが親クラスに強く依存する(is-a)関係の反面、コンポジションはクラスとクラスの間に依存する(has-a)関係になり、保守性が高いです。

## 継承による副作用

継承は色んな問題を抱えている。  
仮に、[10章](https://github.com/bittap/study/tree/main/src/main/java/com/my/study/object/chapter10)の通話料金計算プログラムで以下の要件が追加されたとする。

> 料金プラン計算後固定に割引をするサービス

今の料金プランは二つ[通常料金プラン]と[深夜割引料金プラン]がある。  
![10章クラス図](10章クラス図.PNG)

上記の要件が追加された時のクラス図
![継承による副作用クラス図](継承による副作用クラス図.PNG)

以下の問題点が存在する。
+ 一つの機能を追加・修正するために多くのクラスを追加・修正することになる。  

上記のクラス図の赤枠を見ると一つの機能追加のために二つのクラスが追加されました。  
もし、料金プランが二つ[通常料金プラン]と[深夜割引料金プラン]ではなく、三つまたは四つの場合はその分クラスが増えてしまう。

+ 重複コードが発生する

上記のクラス図の青枠を見るとoverrideしたメソッドが存在する。  
そのメソッドの中の処理は「固定に割引をする」だけで他のクラスでも同様ですが、overrideのために重複コードが発生する。


## 感想

実は本の中では「継承による副作用」の内容はもっとクラスと割引ポリシーがあって長くて複雑だったのです。  
しかし、 それを全部書くと長くなりますし、読みづらくなるかと思って私が必要なところだけ考えて少し変更を加えて書きました。  
それによりもっと理解しやくなったら、嬉しいです。  